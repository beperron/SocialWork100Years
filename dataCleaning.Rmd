---
title: 'History of Social Work Research: Data Cleaning'
output: html_document
---

# Overview

This document summarizes data cleaning procedures of the data file processed by the `ebscoBWR` fucntion.  It should be noted that that `ebscoBWR` function merged the search results from the first- and second-level searches performed on the three databases (psycInfo, Social Science Abstracts, and Social Work Abstract) hosted by the EbscoPlatform.  This function merged all the search results, transformed the data into a structured data file, and removed all duplicate article records.  No further transformations or cleaning was performed by the `ebscoBWR` function.  Provided below are basic descriptive summaries of the results from the full search before further cleaning.  It should be noted that the second-level search was specified to be overly inclusive to help ensure the most comprehensive search possible.  All journal titles from the secondary search are identified in the following summary.  

The main file for analysis is `fullDF.R`, and a separate file is just for psycInfo `psycInfoDF.R`.  The same cleaning procedures need to be performed on both data files prior to analysis.  


# Initialization of workspace

```{r initialization_dataprocessing, warning=FALSE, message=FALSE, eval=TRUE}
# Clear workspace
rm(list=ls())   

# Load required packages
library(ggplot2)
library(dplyr)

# Read data files
#load("/Users/beperron/Git/SocialWorkResearch/Data/psycInfoDF.R")
load("/Users/beperron/Git/SocialWorkResearch/Data/fullDF.R")

# Set the working directory
setwd("/Users/beperron/Git/SocialWorkResearch/Data")

# Strip leading and trailing white-space on all records
full.df$record <- stringr::str_trim(full.df$record, side = "both")
```

# Pre-processing summary

Provided below are some basic descriptive statistics before any data of the files processed by `ebscoBWR` function. 

```{r preprocessing, comment=NA, echo=FALSE} 
number.of.articles <- length(which(full.df$attributes == "article"))
range.of.years <- range(full.df$record[full.df$attributes == "pubYear"])
```


```{r}
# Number of articles
cat(number.of.articles)
```

```{r}
# Range of years
cat(range.of.years)
```

*TO DO* add range of years to the following dplyr summary

```{r date, echo=FALSE, comment=NA}
unique.titles <- filter(full.df, attributes == "journal") %>%
    group_by(record) %>%
    summarise(
        N = n())
print.data.frame(unique.titles, rowNames=FALSE)
```

# Data cleaning

The first step is to exclude years 2014 and 2015 due to delays in indexing.  

```{r}
years <- c("2014", "2015")
ebsco.remove <- full.df[full.df$record %in% years, ]
ebsco.remove <- ebsco.remove[, "articleID"]
full.df <- full.df[!(full.df$articleID %in% ebsco.remove),]


The articles were reviewed and a first round of exclusions were made.  All decisions to exclude were based on group consenus.  

range.of.years <- range(full.df$record[full.df$attributes == "pubYear"])

# New range of years
cat(range.of.years)
```


The articles were reviewed and a first round of exclusions were made based on whether they are journals from within outside of the field of social work.  Disagreements were resolved by reviewing the mission of the journal to see whether it reflected the study definition of a disciplinary social work journal.  

```{r exclusion1, eval=TRUE}
exclusions.1 <- c(
    "American Journal of Preventive Medicine", 
    "Behavior Modification", 
    "Brain and Cognition",
    "Canadian Journal of Community Mental Health",
    "Canadian Journal on Aging",
    "Early Child Development and Care",
    "Early Education and Development",
    "Employee Assistance Quarterly",
    "Evaluation and Program Planning",
    "General Hospital Psychiatry",
    "International Review of Social Research",
    "Journal of Applied Behavioral Science",
    "Journal of Applied Rehabilitation Counseling",
    "Journal of Applied Social Sciences",
    "Journal of Community & Applied Social Psychology",
    "Journal of Health & Human Services Administration",
    "Journal of Nonverbal Behavior",
    "Journal of Psychosomatic Research",
    "Learning Disabilities Research & Practice",
    "New York State Department of Social Welfare, Division Publication",
    "Proceedings of the National Converence of Social Work",
    "PROFILE Issues in Teachers' Professional Development",
    "Psychotherapy",
    "Social Service Department, Presbyterian Hospital, New York",
    "Social Work Technique", 
    "Social Work Today", 
    "Social Work Yearbook", 
    "The New Social Worker",
    "Systems Research and Behavioral Science",
    "Teaching and Teacher Education",
    "University of Chicago Social Service Monograph",
    "The Scientific Review of Mental Health Practice",
    "The Clinical Supervisor",
    "University of Chicago Social Service Monograph")

ebsco.remove <- full.df[full.df$record %in% exclusions.1, ]
ebsco.remove <- ebsco.remove[, "articleID"]
full.df <- full.df[!(full.df$articleID %in% ebsco.remove),]

rm(ebsco.remove)
```

Journal titles were merged in the following situations:

1.
2.
3.

```{r}
full.df$record <- ifelse(full.df$record == 
    "Eugenics and Social Welfare Bulletin",     # Spelling difference
    "Eugenics & Social Welfare Bull.",          # Spelling difference
                    full.df$record)

full.df$record <- ifelse(full.df$record == 
    "The British Journal of Social Work",       # Old name
    "British Journal of Social Work",           # New name
                    full.df$record)

full.df$record <- ifelse(full.df$record == 
    "Social Work & Social Sciences Review",     # Spelling difference
    "Social Work and Social Sciences Review",   # Spelling difference
                    full.df$record)

full.df$record <- ifelse(full.df$record == 
    "Social Work with Groups",                  # Spelling difference
    "Social Work With Groups",                  # Spelling difference
                    full.df$record)

full.df$record <- ifelse(full.df$record == 
    "Computers in Human Services",              # Old name
    "Journal of Technology in Human Services",  # New name 
                    full.df$record)

full.df$record <- ifelse(full.df$record == 
    "Journal of Sociology & Social Welfare",    # Spelling difference
    "Journal of Sociology and Social Welfare",  # Spelling difference
                    full.df$record)

full.df$record <- ifelse(full.df$record == 
    "The Family" | full.df$record ==                   # Old name
    "Journal of Social Casework" | full.df$record ==    # Old name
    "Social Casework",                                  # Old name
    "Families in Society",                              # New name
                    full.df$record)

full.df$record <- ifelse(full.df$record == 
    "Social Work in Education",                 # Old name
    "Children & Schools",                       # New name
                    full.df$record)

full.df$record <- ifelse(full.df$record == "Contemporary Rural Social Work (Electronic only) ", 
                        "Contemporary Rural Social Work (Electronic only) ", full.df$record) 

```



A second round of exclusions were made.  

Journals with less than 10 articles that contributed to the overall number.  Ten was selected because it was a natural break consisten with a EFA curve...In this cases the exclusion of the titles had virtually no impact on the overall article count.  However, it did inflate the number of journal titles.   Excluded if we could not identify the journal and associated articles -- that is, it wasn't available and, therefore, not part of the scholarly record.  

+ _Social Work Process_ was retained because it was a verified journal from U Penn 



```{r exclusion2, eval=TRUE}
exclusions.2 <- c(
    "Eugenics and Social Welfare Bulletin",
    "Eugenics & Social Welfare Bull.",
    "Issues in Social Work Education", 
    "Hospital Social Service",  #Confirmed nursing journal
    "International Conference of Social Work",
    "Journal of Multicultural Social Work",
    "Journal of Teaching in Social Work", 
    "Maatskaplike Werk/Social Work",
    "Medical Social Work",
    "New York State Department of Social Welfare, Division Publication",
    "Pediatric Social Work", 
    "Pennsylvania Social Work",
    "Social Service",    
    "Social Service Department, Presbyterian Hospital, New York",
    "Social Service Monographs",
    "School Social Work Quarterly", # Published only one edition
    "Social Work Today",
    "Social Work Technique",
    "Social Work Today", # Magazine
    "Social Work Yearbook",
    "The New Social Worker",
    "Pennsylvania Social Work",
    "University of Chicago Social Service Monograph" # Single record
    )

ebsco.remove <- full.df[full.df$record %in% exclusions.2, ]
ebsco.remove <- ebsco.remove[, "articleID"]
full.df <- full.df[!(full.df$articleID %in% ebsco.remove),]

rm(ebsco.remove, exclusions.2)
```


Journal titles were merged in the following situations:


```{r titleMerge, eval=TRUE}
full.df$record <- ifelse(full.df$record == "The British Journal of Social Work", 
                       "British Journal of Social Work", 
                        full.df$record)

full.df$record <- ifelse(full.df$record == "Social Work & Social Sciences Review", 
                       "Social Work and Social Sciences Review", 
                        full.df$record)

full.df$record <- ifelse(full.df$record == "Social Work with Groups", 
                       "Social Work With Groups", 
                        full.df$record)

full.df$record <- ifelse(full.df$record == "Computers in Human Services", 
                       "Journal of Technology in Human Services", 
                        full.df$record)

full.df$record <- ifelse(full.df$record == "Journal of Sociology & Social Welfare", 
                       "Journal of Sociology and Social Welfare", 
                        full.df$record)

full.df$record <- ifelse(full.df$record == "The Family", 
                       "Families in Society",
                       ifelse(full.df$record == "Journal of Social Casework",
                       "Families in Society",
                       ifelse(full.df$record == "Social Casework",
                       "Families in Society",
                        full.df$record)))

full.df$record <- ifelse(full.df$record == "Social Work in Education", 
                       "Children & Schools", 
                        full.df$record)
```


# Coverage via Hodge article

```{r hodgeCompare, eval=FALSE}
hodge <- readLines("/Users/beperron/Git/SocialWorkResearch/search_specifications/hodge.txt", n = -1)
hodge2 <- gsub("(SO)", "", hodge)
hodge3 <- gsub("(OR)", "", hodge2)
hodge4 <- gsub("[[:punct:]]", "", hodge3)
hodge5 <- str_trim(hodge4, side="both")

```

# Post-processing summary 

+ to do ... summary with hodge list

```{r echo=FALSE, comment=NA}
unique.titles <- filter(full.df, attributes == "journal") %>%
    group_by(record) %>%
    summarise(
        N = n())
print.data.frame(unique.titles, rowNames=FALSE)
```

```{r comment=NA, echo=FALSE} 
number.of.articles <- length(which(full.df$attributes == "article"))
range.of.years <- range(full.df$record[full.df$attributes == "pubYear"])
```


```{r}
# Number of articles
cat(number.of.articles)
```

```{r}
# Range of years
cat(range.of.years)
```

*TO DO* add range of years to the following dplyr summary

```{r echo=FALSE, comment=NA}
unique.titles <- filter(full.df, attributes == "journal") %>%
    group_by(record) %>%
    summarise(
        N = n())
print.data.frame(unique.titles, rowNames=FALSE)
```

names(full.df)
