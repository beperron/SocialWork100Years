---
title: "History of Social Work Research"
author: "Summary of Data Cleaning Procedures"
output: pdf_document
---

# Overview

This document summarizes data cleaning procedures of the data file processed by the `ebscoBWR` fucntion.  It should be noted that that `ebscoBWR` function merged the search results from the first- and second-level searches performed on the three databases (psycInfo, Social Science Abstracts, and Social Work Abstract) hosted by the EbscoPlatform.  This function merged all the search results, transformed the data into a structured data file, and removed all duplicate article records.  No further transformations or cleaning was performed by the `ebscoBWR` function.  Provided below are basic descriptive summaries of the results from the full search before further cleaning.  

The main file for analysis is `fullDF.R`, and a separate file is just for psycInfo `psycInfoDF.R`.  The same cleaning procedures need to be performed on both data files prior to analysis.  


# Initialization of workspace

```{r initialization_dataprocessing, warning=FALSE, message=FALSE, eval=TRUE}
# Clear workspace
rm(list=ls())   

# Load required packages
library(ggplot2)
library(dplyr)

# Read data files
#load("/Users/beperron/Git/SocialWorkResearch/Data/psycInfoDF.R")
load("/Users/beperron/Git/SocialWorkResearch/Data/fullDF.R")

# Set the working directory
setwd("/Users/beperron/Git/SocialWorkResearch/Data")

# Strip leading and trailing white-space on all records
full.df$record <- stringr::str_trim(full.df$record, side = "both")
```

# Pre-processing summary
```{r echo=FALSE}
full.df$record <- ifelse(full.df$record == 
        "Social Work & Social Sciences Review",     # Spelling difference
        "Social Work and Social Sciences Review", 
                        full.df$record)

full.df$record <- ifelse(full.df$record == 
        "Social Work with Groups",                  # Spelling difference
        "Social Work With Groups", 
                        full.df$record)

full.df$record <- ifelse(full.df$record == 
        "Journal of Sociology & Social Welfare",    # Spelling difference
        "Journal of Sociology and Social Welfare",  
                        full.df$record)
```


Provided below is a summary of the datafile processed by `ebscoBWR` function before any cleaning procedures specifically for this project were employed, with the exception of resolving spelling errors or differences.  For example, _Social Work With Groups_ was exported as a separate journal than _Social Work with Groups_ (note the capitalization difference in the word _with_.)

```{r preprocessing, comment=NA, echo=TRUE} 
number.of.articles <- length(which(full.df$attributes == "article"))
range.of.years <- range(full.df$record[full.df$attributes == "pubYear"])
```


```{r}
# Number of articles
cat(number.of.articles)
```

```{r}
# Range of years
cat(range.of.years)
```


```{r date, echo=FALSE, comment=NA}
unique.titles <- filter(full.df, attributes == "journal") %>%
    group_by(record) %>%
    summarise(
        N = n())
print.data.frame(unique.titles, rowNames=FALSE)
```

# Data cleaning

Inspection of the data indicated notable delays in indexing for the years 2014 and 2015.  Therefore, these years were excluded from the current study.  Thus, this study includes journals indexed through the end of 2013.  

## Year specification

```{r}
years <- c("2014", "2015")
ebsco.remove <- full.df[full.df$record %in% years, ]
ebsco.remove <- ebsco.remove[, "articleID"]
full.df <- full.df[!(full.df$articleID %in% ebsco.remove),]
```

## Exclusion of journals not meeting supplemental search terms

The search for journals involved a two-stage process.  It began by extracting all records from journals based on the social work journal list of Hodge and L (APA cite).  Journals were excluded if they did not contain one of the major search terms from the supplemental list.  The majority of these journals were captured in the supplemental search query because the journal used one of the supplemental search terms in a special issue.  The mission and scope of journals were also reviewed when it was unclear whether the journal was specific to social work research (e.g., _The Clinical Supervisor_).  The supplemental search terms included:

+ social work
+ social welfare
+ social casework (or social case work)
+ social service
+ human service
+ social development 
+ social environment


```{r exclusion1, eval=TRUE}
exclusions.1 <- c(
    "American Journal of Preventive Medicine", 
    "Behavior Modification", 
    "Brain and Cognition",
    "Canadian Journal of Community Mental Health",
    "Canadian Journal on Aging",
    "Early Child Development and Care",
    "Early Education and Development",
    "Employee Assistance Quarterly",
    "Evaluation and Program Planning",
    "General Hospital Psychiatry",
    "International Review of Social Research",
    "Journal of Applied Behavioral Science",
    "Journal of Applied Rehabilitation Counseling",
    "Journal of Community & Applied Social Psychology",
    "Journal of Health & Human Services Administration",
    "Journal of Nonverbal Behavior",
    "Journal of Psychosomatic Research",
    "Learning Disabilities Research & Practice",
    "PROFILE Issues in Teachers' Professional Development",
    "Psychotherapy",
    "Systems Research and Behavioral Science",
    "Teaching and Teacher Education",
    "The Scientific Review of Mental Health Practice",
    "The Clinical Supervisor")

ebsco.remove <- full.df[full.df$record %in% exclusions.1, ]
ebsco.remove <- ebsco.remove[, "articleID"]
full.df <- full.df[!(full.df$articleID %in% ebsco.remove),]

rm(ebsco.remove)
```

## Exclusions of social work publications

Exclusions were then made any of the three criteria   

+ Journals that did not have clear evidence of a peer review process.  This was based on a review of the journals mission, scope, and whether an editorial board or group could be identified.  

+ Journal titles that did not have any clear publication history (e.g., due to an indexing error).  This exclusion was based on errors in data entry.  

+ Journals that did not have at least one full year of indexed records (except journals that subsequently changed titles).  This exclusionary criterion was consistent with the working definition of a social work journal.  

```{r exclusion2, eval=TRUE}
exclusions.2 <- c(
    "Eugenics and Social Welfare Bulletin",
    "Eugenics & Social Welfare Bull.",
    "Issues in Social Work Education", 
    "Hospital Social Service",  #Confirmed nursing journal
    "International Conference of Social Work",
    "Journal of Multicultural Social Work",
    "Journal of Social Work Process",
    "Journal of Teaching in Social Work", 
    "Maatskaplike Werk/Social Work",
    "Medical Social Work",
    "New York State Department of Social Welfare, Division Publication",
    "Pediatric Social Work", 
    "Pennsylvania Social Work",
    "Proceedings of the National Conference of Social Work","Social Service",    
    "Social Service Department, Presbyterian Hospital, New York",
    "Social Service Monographs",
    "School Social Work Quarterly", 
    "Social Work Today",
    "Social Work Technique",
    "Social Work Today", 
    "Social Work Yearbook",
    "Pennsylvania Social Work",
    "University of Chicago Social Service Monograph" 
    )

ebsco.remove <- full.df[full.df$record %in% exclusions.2, ]
ebsco.remove <- ebsco.remove[, "articleID"]
full.df <- full.df[!(full.df$articleID %in% ebsco.remove),]

rm(ebsco.remove, exclusions.2)
```

## Title merging

Some social work journals changed titles over their history.  For example, _Families in Society_ had three titles that preceded the current title:  _Social Casework_, _Journal of Social Casework_, and _The Family_.  The database that contributed the largest number of articles to the study database indexed the majority of journal titles under the journal's current name, and provided an additional data field for the historical name.  However, historical names from Social Science Abstracts and Social Work Abstracts were not merged with the current name.  Thus, the last step of the data cleaning procedures was to conduct these merges.  

```{r titleMerge, eval=TRUE}
full.df$record <- ifelse(full.df$record == 
        "The British Journal of Pyschiatric Social Work",       # Old title
        "British Journal of Social Work",           # New title
                        full.df$record)

full.df$record <- ifelse(full.df$record == 
        "Computers in Human Services",              # Old title
        "Journal of Technology in Human Services",  # New title
                        full.df$record)


full.df$record <- ifelse(full.df$record == 
        "The Family" | full.df$record ==                    # Old title
        "Journal of Social Casework" | full.df$record ==    # Old title
        "Social Casework",                                  # Old title
        "Families in Society",                              # New title
                        full.df$record)

full.df$record <- ifelse(full.df$record == 
        "Social Work in Education",                 # Old title
        "Children & Schools",                       # New title
                    full.df$record)

full.df$record <- ifelse(full.df$record == "Journal of Independent Social Work" | full.df$record == "Journal of Analytic Social Work", "Psychoanalytic Social Work", 
                full.df$record)

# Journals were originally merged after suffixes were eliminated (after the colon).  Thus, Practice: Social Work in Action  (new title) was shortened to Practice (old title).  This section resolves two of these issues to be consistent in the comparison with Hodge.  

practice.temp <- grep("^Practice$", full.df$record)
full.df$record[practice.temp] <- "Practice: Social Work in Action"

practice.temp <- grep("^Reflections$", full.df$record)
full.df$record[practice.temp] <- "Reflections: Narratives of Professional Helping"
```


# Coverage via Hodge article

```{r hodgeCompare, eval=FALSE}
hodge <- readLines("/Users/beperron/Git/SocialWorkResearch/search_specifications/hodge.txt", n = -1)

unique.titles <- filter(full.df, attributes == "journal") %>%
    group_by(record) %>%
    summarise(
        N = n())
print.data.frame(unique.titles, rowNames=FALSE)

```

# Post-processing summary 

+ to do ... summary with hodge list

```{r echo=FALSE, comment=NA}
unique.titles <- filter(full.df, attributes == "journal") %>%
    group_by(record) %>%
    summarise(N = n())

hodge <- readLines("/Users/beperron/Git/SocialWorkResearch/search_specifications/hodge.txt", n = -1)

unique.titles <- filter(full.df, attributes == "journal") %>%
    group_by(record) %>%
    mutate(Hodge.list = ifelse(record %in% hodge == TRUE, 1, 0)) %>%
    summarise(N = n(), 
              Hodge.list = max(Hodge.list)) %>%
    mutate(Hodge = ifelse(Hodge.list == 1, "Y", "N"))


n.so.yr <- filter(full.df, attributes == "journal" | attributes == "pubYear")

n.so <- filter(full.df, attributes == "journal") %>% mutate(title = record) %>% 
        select(-attributes, -record)

n.yr <- filter(full.df, attributes == "pubYear") %>% mutate(year = record ) %>% 
        select(-attributes, -record)

n.so.yr <- left_join(n.so, n.yr) %>%
    group_by(title) %>%
    summarise(first = min(year), last = max(year), n = n()) %>%
    arrange(title)

H <- unique.titles$Hodge

final.list <- cbind(n.so.yr, H)

print.data.frame(final.list, row.names=FALSE)
```

## Intersection, Differences and Union

This section examines the overall _coverage_ of the current search by making systematic comparisons with Hodge (2013).  The first analysis shows how the list of SWH overlaps with HL -- that is, the journals that were common to both lists (_intersection_).  The sedond analyses shows the set _differences_.  The third analysis focuses on the union of the sets.  The union shows a meta-list by 
```{r}


hodge <- readLines("/Users/beperron/Git/SocialWorkResearch/search_specifications/hodge.txt", n = -1)

unique.swHistory <- filter(full.df, attributes == "journal") %>%
                distinct(record)

hodge.swHistory.intersect <- intersect(hodge, unique.swHistory$record)

hodge.swHistory.diff <- setdiff(hodge, unique.swHistory$record)
swHistory.hodge.diff <- setdiff(unique.swHistory$record, hodge)


hodge.swHistory.union <- union(hodge, unique.swHistory$record)

print(sort(hodge.swHistory.intersect))
print(sort(hodge.swHistory.diff))
print(sort(swHistory.hodge.diff))
print(sort(hodge.swHistory.union))



```


```{r}
# Number of articles
cat(number.of.articles)
```

```{r}
# Range of years
cat(range.of.years)
```

Reflections: Narratives of Professional Helping
